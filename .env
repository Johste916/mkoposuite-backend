# =============================================================================
# 🗃️ DATABASES
# =============================================================================

# ───────────────────────
# 🌍 Production (Supabase)
# ───────────────────────
# Only read when NODE_ENV=production by your sequelize config.
DATABASE_URL=postgresql://postgres.wmqicrqpffbcosxvkfci:Johsta67!@aws-0-eu-central-1.pooler.supabase.com:6543/postgres

# For Supabase/pgbouncer production you typically want SSL:
# PGSSLMODE=require
# DB_SSL=true
# (keep disabled while developing locally)
PGSSLMODE=disable
DB_SSL=false

# ───────────────────────
# 🖥️ Local Development DB
# ───────────────────────
DB_USER=postgres
DB_PASS=Johsta67!
DB_NAME=johsta_lms
DB_HOST=127.0.0.1
DB_PORT=5432


# =============================================================================
# 🧩 PLATFORM / TENANCY
# =============================================================================
MULTI_TENANT_MODE=optional
# Default tenant used by background jobs, bootstrap, or when none is supplied
DEFAULT_TENANT_ID=00000000-0000-0000-0000-000000000000

# Helpful defaults for TZ deployments
DEFAULT_COUNTRY=TZ
DEFAULT_CURRENCY=TZS


# =============================================================================
# 🔐 AUTH / WEB
# =============================================================================
JWT_SECRET=mkoposuite_secure_2024
JWT_EXPIRES_IN=7d
PORT=10000

# Your primary deployed frontend URL (used for redirects/CORS defaults)
FRONTEND_URL=https://strong-fudge-7fc28d.netlify.app
# Comma-separated list of allowed origins for CORS
CORS_ALLOW_ORIGINS=http://localhost:5173,https://strong-fudge-7fc28d.netlify.app

# Global rate limit for the public API (per IP). If unset, defaults to 120.
RATE_LIMIT_MAX=120


# =============================================================================
# ⚙️ RUNTIME
# =============================================================================
# Use "production" in production infra so DATABASE_URL + SSL are honored.
NODE_ENV=development
# Africa/Nairobi covers TZ and DST rules for KE/TZ region
TZ=Africa/Nairobi


# =============================================================================
# 🔁 ONE-OFF SYNC FLAGS (optional; keep false unless running maintenance)
# =============================================================================
SYNC_SETTINGS_ONLY=false
SYNC_ACL=false
SYNC_AUDIT=false
SYNC_SAVINGS=false


# =============================================================================
# 🆕 SELF-SERVICE SIGNUP (public /api/signup)
# =============================================================================
SELF_SIGNUP_ENABLED=1
DEFAULT_TRIAL_DAYS=14
REQUIRE_EMAIL_VERIFICATION=0

# (Optional) SMTP for verification/reset emails
# SMTP_HOST=smtp.yourprovider.com
# SMTP_PORT=587
# SMTP_USER=apikey-or-username
# SMTP_PASS=super-secret
# SMTP_FROM="MkopoSuite <no-reply@yourdomain.com>"

# (Optional) If you add captcha to signup later
# RECAPTCHA_SECRET=<your-secret>


# =============================================================================
# ✉️  SMS — sms.co.tz integration (used by routes/smsRoutes.js)
# =============================================================================

# Choose ONE auth method:
# 1) API key (if the provider issues one)
# SMS_CO_TZ_API_KEY=
# 2) Current username/password credentials
SMS_CO_TZ_USERNAME=TIMIZA MAONO
SMS_CO_TZ_PASSWORD=timizamaono2019

# Provider API base (keep default)
SMS_CO_TZ_API_BASE=https://www.sms.co.tz/api.php

# Sender ID behavior:
# - The backend now derives the default Sender ID from the company profile
#   (first word of tenant/org name, sanitized & <=11 chars).
# - If that fails, it falls back to SMS_CO_TZ_SENDER_DEFAULT below.
# - Setting SMS_ALLOW_BODY_SENDERID=true will allow requests to override Sender ID.
SMS_CO_TZ_SENDER_DEFAULT=TIMIZAMAONO
SMS_ALLOW_BODY_SENDERID=false

# Optional per-tenant mapping (if specific tenants need fixed approved senders)
# Format: JSON object of { "<tenantId>": "APPROVEDSENDER" }
SMS_SENDER_MAP_JSON={"00000000-0000-0000-0000-000000000000":"TIMIZAMAONO"}

# Throughput and testing
SMS_RATE_PER_MIN=60     # server-side per-tenant safety limit
SMS_DRY_RUN=0           # set to 1 to test without sending real SMS

# Country code used by number normalizer (accepts +255 or 255)
DEFAULT_COUNTRY_CODE=+255

# Balance display tuning (used for nice UI labels)
SMS_UNIT_NAME=credits
# If you know your cost per segment (credits or TZS), set this so we can estimate
# remaining SMS segments on the balance card. If unknown, leave 0.
SMS_PRICE_PER_SEGMENT=0
# Alternative variable name kept for compatibility; either can be used:
# SMS_TZS_PER_SEGMENT=0
